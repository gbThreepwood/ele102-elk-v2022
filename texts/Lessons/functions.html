<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    
    <title>Functions &mdash; ELE102 Microcontroller course v1.1.0 documentation</title>
    <meta name="description" content="">
    <meta name="author" content="">

    

<link rel="stylesheet" href="../../_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" id="current-theme" href="../../_static/css/bootstrap3/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" id="current-adjust-theme" type="text/css" />

<link rel="stylesheet" href="../../_static/css/font-awesome.min.css">

<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
</style>

<link rel="stylesheet" href="../../_static/css/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
<link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
<link rel="stylesheet" href="../../_static/css/basicstrap.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '../../',
            VERSION:     'v1.1.0',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery.min.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" src="../../_static/js/bootstrap3.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="../../_static/js/basicstrap.js"></script>
<script type="text/javascript">
</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="top" title="ELE102 Microcontroller course v1.1.0 documentation" href="../../index.html" /> 
  </head>
  <body role="document">
    <div id="navbar-top" class="navbar navbar-fixed-top navbar-default" role="navigation" aria-label="top navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../index.html">ELE102 Microcontroller course v1.1.0 documentation</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
              <li class="dropdown visible-xs">
                <a role="button" id="localToc" data-toggle="dropdown" data-target="#" href="#">Table Of Contents <b class="caret"></b></a>
                <ul class="dropdown-menu localtoc sp-localtoc" role="menu" aria-labelledby="localToc">
                <ul>
<li><a class="reference internal" href="#">Functions</a><ul>
<li><a class="reference internal" href="#functions-in-c">Functions in C</a><ul>
<li><a class="reference internal" href="#function-syntax">Function syntax</a></li>
</ul>
</li>
<li><a class="reference internal" href="#functions-in-arduino">Functions in Arduino</a><ul>
<li><a class="reference internal" href="#function-to-initialize-the-sytem">Function to initialize the sytem</a></li>
<li><a class="reference internal" href="#function-to-abstract-hardware">Function to abstract hardware</a></li>
<li><a class="reference internal" href="#functions-to-do-calculations">Functions to do calculations</a><ul>
<li><a class="reference internal" href="#function-to-calculate-exponentiation">Function to calculate exponentiation</a></li>
<li><a class="reference internal" href="#function-to-compute-square-root">Function to compute square root</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#returning-multiple-values">Returning multiple values</a><ul>
<li><a class="reference internal" href="#using-global-external-variables">Using global (external) variables</a></li>
<li><a class="reference internal" href="#using-a-data-structure">Using a data structure</a></li>
<li><a class="reference internal" href="#using-pointers">Using pointers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pointers">Pointers</a><ul>
<li><a class="reference internal" href="#void-pointers">Void pointers</a></li>
<li><a class="reference internal" href="#function-pointers">Function pointers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#recursive-calling-of-functions">Recursive calling of functions</a><ul>
<li><a class="reference internal" href="#example-1-factorial-function">Example 1 - Factorial function</a></li>
<li><a class="reference internal" href="#example-2-fibonacci-series">Example 2 - Fibonacci Series</a></li>
</ul>
</li>
<li><a class="reference internal" href="#functions-in-separate-files">Functions in separate files</a></li>
</ul>
</li>
</ul>

                </ul>
              </li>

            
              <li><a href="../../genindex.html" title="General Index" accesskey="I">index </a></li>
            

            <li class="visible-xs">
                <form class="search form-search form-inline navbar-form navbar-right sp-searchbox" action="../../search.html" method="get">
                  <div class="input-append input-group">
                    <input type="text" class="search-query form-control" name="q" placeholder="Search...">
                    <span class="input-group-btn">
                    <input type="submit" class="btn" value="Go" />
                    </span>
                  </div>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </li>

            

          </ul>

        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container-fluid">

      <!-- row -->
      <div class="row">
         
<div class="col-md-3 hidden-xs" id="sidebar-wrapper">
  <div class="sidebar hidden-xs" role="navigation" aria-label="main navigation">
<h3><a href="../../index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">Lessons:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="L0_Introduction_elk.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="software_hardware_preparations.html">Software and hardware preparations</a></li>
<li class="toctree-l1"><a class="reference internal" href="L1_UC_intro.html">Lesson 1a: What is a Microcontroller</a></li>
<li class="toctree-l1"><a class="reference internal" href="L2_Arduino_intro.html">Lesson 1b: Introduction to Arduino</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Projects:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Appendices/Additionals.html">Mix</a></li>
</ul>

<div id="searchbox" role="search">
  <h3>Quick search</h3>
  <form class="search form-inline" action="../../search.html" method="get">
      <div class="input-append input-group">
        <input type="text" class="search-query form-control" name="q" placeholder="Search...">
        <span class="input-group-btn">
        <input type="submit" class="btn" value="Go" />
        </span>
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div> 
        

        <div class="col-md-9" id="content-wrapper">
          <div class="document" role="main">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <div class="section" id="functions">
<span id="id1"></span><h1>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="functions-in-c">
<h2>Functions in C<a class="headerlink" href="#functions-in-c" title="Permalink to this headline">¶</a></h2>
<p>A function in C is similar to the function you know from mathematics. It is a grouping of statements to perform a task. Every program will have at least one function, which is the first function to be executed when the program starts. As the program grows in size, splitting the code into different functions makes it easier to manage, and helps you to avoid repeating yourself.</p>
<p>Suppose you need to perform the same taks twice, e.g. compute the square root of two different numbers. The algorithm will be the same, and thus it makes sense to keep it in a separate function. This will make you code more readable, and it will also save memory. When you are using libraries, you are actually calling functions that have been prepared by others.</p>
<p>There are some important points to note about C functions that makes them different from mathematical functions. A function in C does not have to return a value, the effect of calling the function could be to affect some other part of the sytem memory without a explicit return value. The result of a function does not have to be the same, even if you provide the same input twice. I.e. the function may depend on some data that is outside it’s parameter list, or it may have a persistant memory between each call.</p>
<p>Despite these possible differences it is often wise to try and keep as many of the functions as possible behave in a predictable manner. Functions with side effects are harder to test, and debug. Some functions, such as <cite>analogRead()</cite> will depend on the physical state of the analog input, and it would not make sense to have it allways behave the same for different calls. A function converting the raw ADC value to a number representing some physical quantiy however could be made to allways behave the same for a given input. E.g. the input beeing the raw ADC value, and the output beeing the voltage on the pin.</p>
<div class="section" id="function-syntax">
<h3>Function syntax<a class="headerlink" href="#function-syntax" title="Permalink to this headline">¶</a></h3>
<p>A function requires a definition, and one or more declarations.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Declaration */</span><span class="w"></span>
<span class="kt">uint8_t</span><span class="w"> </span><span class="nf">number_squared</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">number</span><span class="p">);</span><span class="w"></span>

<span class="cm">/* Definition */</span><span class="w"></span>
<span class="kt">uint8_t</span><span class="w"> </span><span class="nf">number_squared</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">number</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">number</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="functions-in-arduino">
<h2>Functions in Arduino<a class="headerlink" href="#functions-in-arduino" title="Permalink to this headline">¶</a></h2>
<p>For Arduino we have two functions, <code class="code ccode c docutils literal notranslate"><span class="pre">setup()</span></code>, and <code class="code ccode c docutils literal notranslate"><span class="pre">loop()</span></code> that are allways called. In reality there is another function <code class="code ccode c docutils literal notranslate"><span class="pre">main()</span></code> that calls <code class="code ccode c docutils literal notranslate"><span class="pre">setup()</span></code> first, and the it calls <code class="code ccode c docutils literal notranslate"><span class="pre">loop()</span></code> in a infinite loop. The following code is the actual implementation used:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">init</span><span class="p">();</span><span class="w"></span>

<span class="w">        </span><span class="n">initVariant</span><span class="p">();</span><span class="w"></span>

<span class="cp">#if defined(USBCON)</span>
<span class="w">        </span><span class="n">USBDevice</span><span class="p">.</span><span class="n">attach</span><span class="p">();</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="w">        </span><span class="n">setup</span><span class="p">();</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(;;)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">loop</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">serialEventRun</span><span class="p">)</span><span class="w"> </span><span class="n">serialEventRun</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<div class="section" id="function-to-initialize-the-sytem">
<h3>Function to initialize the sytem<a class="headerlink" href="#function-to-initialize-the-sytem" title="Permalink to this headline">¶</a></h3>
<p>When the controller is booting there is usually some initialization that is required. In order to better organize the code, this could be kept in one or more init functions. The following example illustrates the idea by initializing the UART, as well as one digital input, and one digital output.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">init_controller</span><span class="p">(){</span><span class="w"></span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="n">pinMode</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="n">INPUT</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">pinMode</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="n">OUTPUT</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="function-to-abstract-hardware">
<h3>Function to abstract hardware<a class="headerlink" href="#function-to-abstract-hardware" title="Permalink to this headline">¶</a></h3>
<p>In order to make your programs more portable it is advantageous to try and separate as much as possible of the hardware spesific code from the actual application. This could be achieved by using functions.</p>
<p>The following is a trivial example of a function that abstracts away the actual digital read for a more general start button function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">uint8_t</span><span class="w"> </span><span class="nf">read_start_button</span><span class="p">(){</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">digitalRead</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="functions-to-do-calculations">
<h3>Functions to do calculations<a class="headerlink" href="#functions-to-do-calculations" title="Permalink to this headline">¶</a></h3>
<p>Calculations are good candidates for separation into various functions.</p>
<div class="section" id="function-to-calculate-exponentiation">
<h4>Function to calculate exponentiation<a class="headerlink" href="#function-to-calculate-exponentiation" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">uint16_t</span><span class="w"> </span><span class="nf">power</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">exponent</span><span class="p">){</span><span class="w"></span>
<span class="w">  </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">exponent</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="o">*</span><span class="n">number</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="function-to-compute-square-root">
<h4>Function to compute square root<a class="headerlink" href="#function-to-compute-square-root" title="Permalink to this headline">¶</a></h4>
<p>The following program uses Babylonian method to compute the square root of a number.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">float</span><span class="w"> </span><span class="nf">square_root</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">number</span><span class="p">){</span><span class="w"></span>

<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.00001</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">e</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="returning-multiple-values">
<h2>Returning multiple values<a class="headerlink" href="#returning-multiple-values" title="Permalink to this headline">¶</a></h2>
<p>A function will often need to return more than one value. In this section we will look at some alternative ways to achieve this.</p>
<div class="section" id="using-global-external-variables">
<h3>Using global (external) variables<a class="headerlink" href="#using-global-external-variables" title="Permalink to this headline">¶</a></h3>
<p>Variables that are defined outside any function body are given a global scope. Thus any function will be able to access them. The use of global variables should be limited, but they are useful in some circumstances.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">resultat_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="kt">uint8_t</span><span class="w"> </span><span class="n">resultat_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="kt">int8_t</span><span class="w"> </span><span class="n">resultat_c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="n">berekning</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">c</span><span class="p">){</span><span class="w"></span>

<span class="w">  </span><span class="n">resultat_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">resultat_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">resultat_c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="using-a-data-structure">
<h3>Using a data structure<a class="headerlink" href="#using-a-data-structure" title="Permalink to this headline">¶</a></h3>
<p>The <code class="code ccode c docutils literal notranslate"><span class="pre">return</span></code> statement makes the function return to the caller, providing a single populated data type. The data type could be a integer, or it could be some more advanced data type. If one needs to return more than one value, a custom data type could be used.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">resultat_a</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">resultat_b</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="kt">int8_t</span><span class="w"> </span><span class="n">resultat_c</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">tall_t</span><span class="p">;</span><span class="w"></span>

<span class="n">tall_t</span><span class="w"> </span><span class="nf">berekning2</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">c</span><span class="p">){</span><span class="w"></span>

<span class="w">  </span><span class="n">tall_t</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="n">result</span><span class="p">.</span><span class="n">resultat_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">result</span><span class="p">.</span><span class="n">resultat_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">result</span><span class="p">.</span><span class="n">resultat_c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="using-pointers">
<h3>Using pointers<a class="headerlink" href="#using-pointers" title="Permalink to this headline">¶</a></h3>
<p>Insted of returning the data, the function could manipulate the memory address of data in the calling function. This is achieved using pointers, i.e. variables containing memory addresses to other variables.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">berekning3</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">resultat_a</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">resultat_b</span><span class="p">,</span><span class="w"> </span><span class="kt">int8_t</span><span class="w"> </span><span class="o">*</span><span class="n">resultat_c</span><span class="p">){</span><span class="w"></span>

<span class="w">  </span><span class="o">*</span><span class="n">resultat_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="o">*</span><span class="n">resultat_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="o">*</span><span class="n">resultat_c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pointers">
<h2>Pointers<a class="headerlink" href="#pointers" title="Permalink to this headline">¶</a></h2>
<p>Pointers have many useful applications besides passing data to and from functions.</p>
<p>The following example shows how one can assign specific memory addresses to pointers, and then use the pointers to manipulate those memory locations. The example blinks a LED connected to pin 5 on the Arduino UNO.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * This function demonstrates direct register access for Atmega 328.</span>
<span class="cm"> * You should never use this function for anything but a fun demonstration.</span>
<span class="cm"> * Use the official register map files for any production development.</span>
<span class="cm"> *</span>
<span class="cm"> * PORTD is digital pin 0 - 7 on the Arduino UNO.</span>
<span class="cm"> */</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="nf">register_access_led_blink</span><span class="p">(){</span><span class="w"></span>

<span class="w">  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">port_d_register</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="mh">0x0b</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">data_direction_register_d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="mh">0x0a</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pin_d_register</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="mh">0x09</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">port_d_register_full_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">port_d_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x20</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">data_direction_register_d_full_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_direction_register_d</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x20</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pin_d_register_full_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pin_d_register</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x20</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="o">*</span><span class="n">data_direction_register_d_full_address</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mb">0b11111100</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">for</span><span class="p">(;;){</span><span class="w"></span>
<span class="w">    </span><span class="o">*</span><span class="n">port_d_register_full_address</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"> </span><span class="c1">// Toggle output pin 5.</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<div class="section" id="void-pointers">
<h3>Void pointers<a class="headerlink" href="#void-pointers" title="Permalink to this headline">¶</a></h3>
<p>When declaring a pointer we normally declare the data type, e.g. <code class="code ccode c docutils literal notranslate"><span class="pre">uint8_t</span> <span class="pre">*pointer</span> <span class="pre">=</span> <span class="pre">&amp;variablename;</span></code>. Any address in the Atmega 328 is a 16-bit number (the actual address bus might not be 16-bit, but it is more than 8-bit and thus 16-bits are used).</p>
<p>A void pointer <code class="code ccode c docutils literal notranslate"><span class="pre">void*</span></code> is a pointer that has no data type associated with it. It still takes up the same amount of memory (16-bit on Atmega 328), but it can be used to point to any data type.</p>
</div>
<div class="section" id="function-pointers">
<h3>Function pointers<a class="headerlink" href="#function-pointers" title="Permalink to this headline">¶</a></h3>
<p>Just like pointers to data, the C language also supports pointers to functions. This is a powerful (but advanced) feature of the language, which allows us to implement many usefull design patterns more efficiently.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">fun_ptr</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">function</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">(</span><span class="o">*</span><span class="n">fun_ptr</span><span class="p">)(</span><span class="mi">22</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="recursive-calling-of-functions">
<h2>Recursive calling of functions<a class="headerlink" href="#recursive-calling-of-functions" title="Permalink to this headline">¶</a></h2>
<p>If a function is invoking another instace of itself, this is called a recursive function call. This is usefull in many algorithms.</p>
<div class="section" id="example-1-factorial-function">
<h3>Example 1 - Factorial function<a class="headerlink" href="#example-1-factorial-function" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[n! = n(n - 1)*(n - 2)*(n - 3) \dots\]</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">uint32_t</span><span class="w"> </span><span class="nf">factorial</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">number</span><span class="p">){</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">factorial</span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="example-2-fibonacci-series">
<h3>Example 2 - Fibonacci Series<a class="headerlink" href="#example-2-fibonacci-series" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="functions-in-separate-files">
<h2>Functions in separate files<a class="headerlink" href="#functions-in-separate-files" title="Permalink to this headline">¶</a></h2>
<p>It is often useful to group realted functions as a library by putting them in separate files. This is usuall achieved by putting the definitons in a source file (*.c, or *.cpp) while the declarations are put in a header (*.h) file.</p>
</div>
</div>


                </div>
              </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row footer-relbar">
<div id="navbar-related" class=" related navbar navbar-default" role="navigation" aria-label="related navigation">
  <div class="navbar-inner">
    <ul class="nav navbar-nav ">
        <li><a href="../../index.html">ELE102 Microcontroller course v1.1.0 documentation</a></li>
    </ul>
<ul class="nav navbar-nav pull-right hidden-xs hidden-sm">
      
        <li><a href="../../genindex.html" title="General Index" >index</a></li>
        <li><a href="#">top</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer role="contentinfo">
          &copy; Copyright 2022, Gizem Ateş &amp; Eirik Haustveit.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 4.3.2.
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>